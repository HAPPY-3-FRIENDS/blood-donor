@page
@using Microsoft.AspNetCore.Http
@model PRN221_SE1503_GroupProject_BloodDonor_Happy3Friends.Pages.Campaigns.IndexModel

@{
    ViewData["Title"] = "Home";
}

<h1>Nav Bar giống trang home ở đây (active đặt lịch hiến máu)</h1>
<h2>Đổi giao diện cho xinh, làm bảng thấy ghê lắm</h2>
<h2>Thông tin chiến dịch có thể rút gọn các thông tin quan trọng, sau khi bấm vào details của chiến dịch sẽ hiện chi tiết hơn, và trong tổng quát hay chi tiết đều có nút đăng kí (Đặt lịch) cho người dùng</h2>
<p>
    •	Đóng/mở 1 chiến dịch
    •	Quản lý tình trạng tình nguyện viên tham gia 1 chiến dịch: đã đăng ký, đã tham gia (tình nguyện viên có thể tự do đến tham gia mà không cần đăng kí trước, bệnh viện/hội chữ thập đỏ sẽ đăng kí giúp)

    •	Quản lý lượng máu (ml) của 1 tình nguyện viên trong từng lần hiến máu

    •	Quản lý danh sách chiến dịch (search, view, history, những tình nguyện viên đã tham gia, thông tin cá nhân của mỗi lần hiến máu, lượng máu (ml) được hiến, lượng máu (ml) mỗi loại)

    •	CRUD tài khoản cho tình nguyện viên (View, search, điều chỉnh nhóm máu)

    •	Nhận thông báo, chấp nhận/từ chối yêu cầu nhận máu cho bản thân – người thân của tình nguyện viên
</p>

@if(HttpContext.Session.GetString("role") != null) {
    <li><a style="text-decoration: none" class="getstarted scrollto" asp-area="" asp-page="">Tên tao là: @HttpContext.Session.GetString("name")</a></li>
    <form method="post" asp-page-handler="Logout">
        <div class="form-group">
            <button class="btn btn-outline getstarted scrollto" type="submit">Đăng xuất</button>
        </div>
    </form>
} else {
    {
        HttpContext.Session.SetString("action", "RegisterCampaignsList");
    }
    <li><a style="text-decoration: none" class="getstarted scrollto" asp-area="" asp-page="/Login">Đăng nhập</a></li>
}

@if(HttpContext.Session.GetString("role") == null || HttpContext.Session.GetString("role") != "Admin") {
    <table class="table">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].Description)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].BloodTypeRequired)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].AddressDetails)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].District)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].City)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].StartDate)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Campaigns[0].EndDate)
                </th>
                @if (HttpContext.Session.GetString("role") != "Organization")
                {
                    <th>
                        @Html.DisplayNameFor(model => model.Campaigns[0].Organization.Name)
                    </th>
                }
                @if (HttpContext.Session.GetString("role") == "Organization")
                {
                    <th></th>
                }
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.Campaigns)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Description)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.BloodTypeRequired)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AddressDetails)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.District)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.City)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.StartDate)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.EndDate)
                    </td>
                    @if (HttpContext.Session.GetString("role") != "Organization")
                    {
                        <td>
                            @Html.DisplayFor(modelItem => item.Organization.Name)
                        </td>
                    }
                    @if (HttpContext.Session.GetString("role") == null || HttpContext.Session.GetString("role") == "Volunteer")
                    {
                        <td>
                            <a asp-page="./Details" asp-route-id="@item.Id">Details</a>
                        </td>
                        <td>
                            <a asp-page="./Register" asp-route-campaignId="@item.Id">Đặt lịch</a>
                        </td>
                    }
                    @if (HttpContext.Session.GetString("role") == "Organization")
                    {
                        <td>
                            <a asp-page="./Edit" asp-route-id="@item.Id">Edit</a> |
                            <a asp-page="./Details" asp-route-id="@item.Id">Details</a> |
                            <a asp-page="./Delete" asp-route-id="@item.Id">Delete</a>
                        </td>
                    }
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <h6>Bạn không có quyền truy cập trang này! Trở về <a asp-page="/Organizations/Index">Trang chủ</a></h6>
}